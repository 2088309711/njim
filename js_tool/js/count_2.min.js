var cookie_prefix="count_2_";var loss_count=0;$(function(){load_cookie("num");load_cookie("add");load_cookie("max");load_cookie("miss");load_cookie("method");$("#num").blur(function(){ckNum("num");compute()});$("#add").blur(function(){ckNum("add");compute()});$("#max").blur(function(){ckNum("max");compute()});$("#miss").blur(function(){ckNum("miss");compute()});$(":radio").click(function(){set_cookie($(this).attr("name"),$(this).val());compute()});$("#result").focus(function(){$(this).val("")});$("#result").blur(function(){parseData();compute()})});function parseData(){var e=$("#result").val();$("#result").val("正在解析数据");var a=e.match(/\d{9}/);var f=e.match(/([01][0-9],){9}[01][0-9]/);var c=e.match(/\[\{"id":\d+,"betEndTime":"\d{4}(-\d{2}){2} (\d{2}:){2}\d{2}","turnNum":"\d+","openNum":"(\d{2},){9}\d{2}"/);if(c!=null){var d=$.parseJSON(e);for(var b=0;b<d.length;b++){if(vueData.add(parseInt(d[b].turnNum),splitNumsToInt(d[b].openNum))){$("#result").val("数据录入成功")}else{$("#result").val("数据已存在")}}vueData.sort();vueData.check();d=null}else{if(c==null&&f!=null&&a!=null){a=parseInt(a[0]);f=splitNumsToInt(f[0]);if(vueData.add(a,f)){$("#result").val("数据录入成功")}else{$("#result").val("数据已存在")}}else{$("#result").val("无法识别的数据")}}}function BinaryTree(){var b=function(e){this.key=e;this.left=null;this.right=null};var a=null;var c=function(f,e){if(e.key.issue>f.key.issue){if(f.left===null){f.left=e}else{c(f.left,e)}}else{if(f.right===null){f.right=e}else{c(f.right,e)}}};this.insert=function(f){var e=new b(f);if(a===null){a=e}else{c(a,e)}};var d=function(e,f){if(e!==null){d(e.left,f);f(e.key);d(e.right,f)}};this.inOrderTraverse=function(e){d(a,e)}}function splitNumsToInt(b){b=b.split(",");for(var a=0;a<b.length;a++){b[a]=parseInt(b[a])}return b}function ckNum(a){var d=$("#"+a);var c=trim(d.val());if(/^[0-9]+$/.test(c)){d.val(c);set_cookie(a,c)}else{var b=get_cookie(a);d.val(b)}}function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}setInterval(function(){$("#data").children("iframe").each(function(){var a=this.src.split("?");this.src=a[0]+"?_t="+new Date().getTime()})},5000);function compute(){var h=parseInt($("#num").val());var n=parseInt($("#add").val());var l=parseInt($("#max").val());var e=parseInt($("#miss").val());var a=$("input[name='method']:checked").val();if(isNaN(h)||isNaN(n)||isNaN(l)||isNaN(e)){showMsg("参数不全",2,1000);return}if(vueData.trs.length<e||vueData.trs.length==0){showMsg("数据量不足，无法计算",2,1000);return}for(var g=0;g<e-1;g++){if(vueData.trs[g].issue!==vueData.trs[g+1].issue+1){showMsg("数据断层，停止计算",2,1000);return}}var f=[];var b=["冠军","亚军","第三名","第四名","第五名","第六名","第七名","第八名","第九名","第十名"];for(var g=0;g<vueData.trs[0].nums.length;g++){var m={name:b[g],big:true,small:true,single:true,_double:true,_big:0,_small:0,_single:0,__double:0};if(g<5){m.loong=true;m.tiger=true;m._loong=0;m._tiger=0}for(var d=0;d<e;d++){if(is_big(vueData.trs[d].nums[g])){m.big=false}if(is_small(vueData.trs[d].nums[g])){m.small=false}if(is_single(vueData.trs[d].nums[g])){m.single=false}if(is_double(vueData.trs[d].nums[g])){m._double=false}if(g<5){if(is_loong(vueData.trs[d].nums,g)){m.loong=false}if(is_tiger(vueData.trs[d].nums,g)){m.tiger=false}}}var k=null;for(var d=0;d<vueResult.result.length;d++){if(vueResult.result[d].issue===vueData.trs[0].issue){k=vueResult.result[d]}}if(vueResult.result.length==0||k===null||k.issue!==vueData.trs[0].issue){if(m.big){m._big=h}if(m.small){m._small=h}if(m.single){m._single=h}if(m._double){m.__double=h}if(g<5){if(m.loong){m._loong=h}if(m.tiger){m._tiger=h}}}else{if(m.big){m._big=getNum(k.betting[g]._big,h,n,l)}if(m.small){m._small=getNum(k.betting[g]._small,h,n,l)}if(m.single){m._single=getNum(k.betting[g]._single,h,n,l)}if(m._double){m.__double=getNum(k.betting[g].__double,h,n,l)}if(g<5){if(m.loong){m._loong=getNum(k.betting[g]._loong,h,n,l)}if(m.tiger){m._tiger=getNum(k.betting[g]._tiger,h,n,l)}}}if(a=="2"){if(m._big==h){m._big=0;m.big=false}if(m._small==h){m._small=0;m.small=false}if(m._single==h){m._single=0;m.single=false}if(m.__double==h){m.__double=0;m._double=false}if(g<5){if(m._loong==h){m._loong=0;m.loong=false}if(m._tiger==h){m._tiger=0;m.tiger=false}}}f.push(m)}var c={issue:vueData.trs[0].issue+1,betting:f};vueResult.result.unshift(c)}function getNum(d,c,e,a){if(d===0){return c}else{var b=d*2+e;if(b>a){showMsg("已亏损："+(++loss_count)+"次",5,2000);b=c}return b}}var vueResult=new Vue({el:"#vue-result",data:{info:"录入数据",result:[]},methods:{activeClass:function(a){if(a){return"active"}else{return""}},showLH:function(a){if(a<5){return true}return false},isShow:function(){return this.result.length>0},selectText:function(b){var a=$(b.currentTarget);a.select();a.zclip({path:"/static/zclip/ZeroClipboard.swf",copy:function(){return a.val()},afterCopy:function(){showMsg("复制成功",1,500)}})}}});window.onbeforeunload=function(a){};function showMsg(c,a,b){layer.msg(c,{icon:a,time:b})}function is_big(a){return a>5}function is_small(a){return a<6}function is_single(a){return a%2!=0}function is_double(a){return a%2==0}function is_loong(a,b){return a[b]>a[9-b]}function is_tiger(a,b){return a[b]<a[9-b]}var vueData=new Vue({el:"#vue-data",data:{trs:[]},methods:{add:function(a,b){if(this.get(a)==null){this.trs.unshift({issue:a,nums:b});return true}else{return false}},get:function(a){for(var b=0;b<this.trs.length;b++){if(this.trs[b].issue==a){return this.trs[b]}}return null},sort:function(){var c=new BinaryTree();for(var b=0;b<this.trs.length;b++){c.insert(this.trs[b])}var a=[];c.inOrderTraverse(function(d){a.push(d)});log(a);this.trs=a},check:function(){for(var a=0;a<this.trs.length;a++){if(a+1===this.trs.length){return true}if(this.trs[a].issue!==this.trs[a+1].issue+1){if(this.get(this.trs[a].issue-1)==null){alert((this.trs[a].issue-1)+" 期数据不存在");return false}}}}}});function load_cookie(a){switch(a){case"method":var b=get_cookie(a);$("input[name='"+a+"'][value='"+b+"']").attr("checked",true);break;default:var b=get_cookie(a);if(b!=""){$("#"+a).val(b)}break}}function set_cookie(a,b){var c=new Date();c.setDate(c.getDate()+90);document.cookie=cookie_prefix+a+"="+escape(b)+";expires="+c.toGMTString()+";path=/"}function get_cookie(b){if(document.cookie.length>0){var c=document.cookie.indexOf(cookie_prefix+b+"=");if(c!=-1){c=c+(cookie_prefix+b).length+1;var a=document.cookie.indexOf(";",c);if(a==-1){a=document.cookie.length}return unescape(document.cookie.substring(c,a))}}return""}function log(a){console.log(a)};