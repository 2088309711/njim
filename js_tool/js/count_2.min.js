var cookie_prefix="count_2_";var loss_count=0;$(function(){load_cookie("num");load_cookie("add");load_cookie("max");load_cookie("miss");load_cookie("method");$("#num").blur(function(){ckNum("num");compute()});$("#add").blur(function(){ckNum("add");compute()});$("#max").blur(function(){ckNum("max");compute()});$("#miss").blur(function(){ckNum("miss");compute()});$(":radio").click(function(){set_cookie($(this).attr("name"),$(this).val());compute()});$("#result").focus(function(){$(this).val("")});$("#result").blur(function(){parseData();compute()})});function parseData(){var e=$("#result").val();$("#result").val("正在解析数据");var a=e.match(/\d{9}/);var f=e.match(/([01][0-9],){9}[01][0-9]/);var c=e.match(/\[\{"id":\d+,"betEndTime":"\d{4}(-\d{2}){2} (\d{2}:){2}\d{2}","turnNum":"\d+","openNum":"(\d{2},){9}\d{2}"/);if(c!=null){var d=$.parseJSON(e);for(var b=0;b<d.length;b++){if(vueData.add(parseInt(d[b].turnNum),splitNumsToInt(d[b].openNum))){$("#result").val("数据录入成功")}else{$("#result").val("数据已存在")}}vueData.sort();vueData.check();d=null}else{if(c==null&&f!=null&&a!=null){a=parseInt(a[0]);f=splitNumsToInt(f[0]);if(vueData.add(a,f)){$("#result").val("数据录入成功")}else{$("#result").val("数据已存在")}}else{$("#result").val("无法识别的数据")}}}function BinaryTree(){var b=function(e){this.key=e;this.left=null;this.right=null};var a=null;var c=function(f,e){if(e.key.issue>f.key.issue){if(f.left===null){f.left=e}else{c(f.left,e)}}else{if(f.right===null){f.right=e}else{c(f.right,e)}}};this.insert=function(f){var e=new b(f);if(a===null){a=e}else{c(a,e)}};var d=function(e,f){if(e!==null){d(e.left,f);f(e.key);d(e.right,f)}};this.inOrderTraverse=function(e){d(a,e)}}function splitNumsToInt(b){b=b.split(",");for(var a=0;a<b.length;a++){b[a]=parseInt(b[a])}return b}function ckNum(a){var d=$("#"+a);var c=trim(d.val());if(/^[0-9]+$/.test(c)){d.val(c);set_cookie(a,c)}else{var b=get_cookie(a);d.val(b)}}function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}setInterval(function(){$("#data").children("iframe").each(function(){var a=this.src.split("?");this.src=a[0]+"?_t="+new Date().getTime()})},5000);function compute(){var g=parseInt($("#num").val());var l=parseInt($("#add").val());var k=parseInt($("#max").val());var d=parseInt($("#miss").val());var a=$("input[name='method']:checked").val();if(isNaN(g)||isNaN(l)||isNaN(k)||isNaN(d)){showMsg("参数不全",2,1000);return}if(vueData.trs.length<d||vueData.trs.length==0){showMsg("数据量不足，无法计算",2,1000);return}for(var f=0;f<d-1;f++){if(vueData.trs[f].issue!==vueData.trs[f+1].issue+1){showMsg("数据断层，停止计算",2,1000);return}}var e=[];var b=["冠军","亚军","第三名","第四名","第五名","第六名","第七名","第八名","第九名","第十名"];for(var f=0;f<vueData.trs[0].nums.length;f++){var j=computeTwoSides(f,b[f],g,l,k,d);var h=computeOneToTen(f,b[f],g,l,k,d);e.push(temp)}var c={issue:vueData.trs[0].issue+1,betting:e};vueResult.result.unshift(c)}function alertObj(a){alert(JSON.stringify(a))}function computeTwoSides(e,a,d,i,g,b){var h={name:a,big:true,small:true,single:true,_double:true,_big:0,_small:0,_single:0,__double:0};if(e<5){h.loong=true;h.tiger=true;h._loong=0;h._tiger=0}for(var c=0;c<b;c++){if(is_big(vueData.trs[c].nums[e])){h.big=false}if(is_small(vueData.trs[c].nums[e])){h.small=false}if(is_single(vueData.trs[c].nums[e])){h.single=false}if(is_double(vueData.trs[c].nums[e])){h._double=false}if(e<5){if(is_loong(vueData.trs[c].nums,e)){h.loong=false}if(is_tiger(vueData.trs[c].nums,e)){h.tiger=false}}}var f=null;for(var c=0;c<vueResult.result.length;c++){if(vueResult.result[c].issue===vueData.trs[0].issue){f=vueResult.result[c]}}if(f===null||f.issue!==vueData.trs[0].issue){if(h.big){h._big=d}if(h.small){h._small=d}if(h.single){h._single=d}if(h._double){h.__double=d}if(e<5){if(h.loong){h._loong=d}if(h.tiger){h._tiger=d}}}else{if(h.big){h._big=getNum(f.betting[e]._big,d,i,g)}if(h.small){h._small=getNum(f.betting[e]._small,d,i,g)}if(h.single){h._single=getNum(f.betting[e]._single,d,i,g)}if(h._double){h.__double=getNum(f.betting[e].__double,d,i,g)}if(e<5){if(h.loong){h._loong=getNum(f.betting[e]._loong,d,i,g)}if(h.tiger){h._tiger=getNum(f.betting[e]._tiger,d,i,g)}}}if(method=="2"){if(h._big==d){h._big=0;h.big=false}if(h._small==d){h._small=0;h.small=false}if(h._single==d){h._single=0;h.single=false}if(h.__double==d){h.__double=0;h._double=false}if(e<5){if(h._loong==d){h._loong=0;h.loong=false}if(h._tiger==d){h._tiger=0;h.tiger=false}}}return h}function computeOneToTen(d,s,f,k,n,a){var h=20;var l=function(i){return{number:i,betting:false,num:0,miss:0,frequency:0,total_sum:0}};var b=function(v,t){for(var u=0;u<vueData.trs.length;u++){if(vueData.trs[u].nums[t]===v){return u}}};var q={name:s,nums:[]};for(var o=0;o<10;o++){q.nums[o]=new l(o+1)}var c=vueResult.get(vueData.trs[0].issue);for(var o=0;o<q.nums.length;o++){q.nums[o].miss=b(q.nums[o].number,o);if(q.nums[o].miss>=h){q.nums[o].betting=true;if(c==null){q.nums[o].num=f;q.nums[o].frequency=1;q.nums[o].total_sum=f}else{var p=c.oneToTen[d].nums[o].num;var r=c.oneToTen[d].nums[o].total_sum;var j=c.oneToTen[d].nums[o].frequency;var e=1;var g=9.99;var m=true;while(m){if(e*g>r+e){m=true}else{e++}}q.nums[o].num=e;q.nums[o].frequency=j+1;q.nums[o].total_sum=r+e}}}return q}function getNum(d,c,e,a){if(d===0){return c}else{var b=d*2+e;if(b>a){showMsg("已亏损："+(++loss_count)+"次",5,2000);b=c}return b}}var vueResult=new Vue({el:"#vue-result",data:{info:"录入数据",result:[]},methods:{activeClass:function(a){if(a){return"active"}else{return""}},showLH:function(a){if(a<5){return true}return false},isShow:function(){return this.result.length>0},selectText:function(b){var a=$(b.currentTarget);a.zclip({path:"/static/zclip/ZeroClipboard.swf",copy:function(){return a.val()},afterCopy:function(){showMsg("复制成功",1,500)}})},getIndex:function(a){for(var b=0;b<this.result.length;b++){if(this.result[b].issue===a){return b}}return -1},get:function(a){for(var b=0;b<this.result.length;b++){if(this.result[b].issue===a){return this.result[b]}}return null},add:function(b){var a=this.getIndex(b.isssue);if(a>-1){this.result[a]=b}else{this.unshift(b)}}}});window.onbeforeunload=function(a){};function showMsg(c,a,b){layer.msg(c,{icon:a,time:b})}function is_big(a){return a>5}function is_small(a){return a<6}function is_single(a){return a%2!=0}function is_double(a){return a%2==0}function is_loong(a,b){return a[b]>a[9-b]}function is_tiger(a,b){return a[b]<a[9-b]}var vueData=new Vue({el:"#vue-data",data:{trs:[]},methods:{add:function(a,b){if(this.get(a)==null){this.trs.unshift({issue:a,nums:b});return true}else{return false}},get:function(a){for(var b=0;b<this.trs.length;b++){if(this.trs[b].issue==a){return this.trs[b]}}return null},sort:function(){var c=new BinaryTree();for(var b=0;b<this.trs.length;b++){c.insert(this.trs[b])}var a=[];c.inOrderTraverse(function(d){a.push(d)});log(a);this.trs=a},check:function(){for(var a=0;a<this.trs.length;a++){if(a+1===this.trs.length){return true}if(this.trs[a].issue!==this.trs[a+1].issue+1){if(this.get(this.trs[a].issue-1)==null){alert((this.trs[a].issue-1)+" 期数据不存在");return false}}}}}});function load_cookie(a){switch(a){case"method":var b=get_cookie(a);$("input[name='"+a+"'][value='"+b+"']").attr("checked",true);break;default:var b=get_cookie(a);if(b!=""){$("#"+a).val(b)}break}}function set_cookie(a,b){var c=new Date();c.setDate(c.getDate()+90);document.cookie=cookie_prefix+a+"="+escape(b)+";expires="+c.toGMTString()+";path=/"}function get_cookie(b){if(document.cookie.length>0){var c=document.cookie.indexOf(cookie_prefix+b+"=");if(c!=-1){c=c+(cookie_prefix+b).length+1;var a=document.cookie.indexOf(";",c);if(a==-1){a=document.cookie.length}return unescape(document.cookie.substring(c,a))}}return""}function log(a){console.log(a)};